# netmonitor for Storm#

netmonitor for Storm helps you to collect network statistics from your Storm cluster

### Dependencies ###

* Python 3.x
* [Flask](http://flask.pocoo.org/) on server
```
sudo pip3 install flask
```
* `requests` module on client
```
sudo pip3 install requests
```

### Features ###

#### tcpprobe Parser ####
The module `tcpprobe.py` implements a class that parse a packet line generated by [tcp_probe](https://wiki.linuxfoundation.org/networking/tcpprobe), generating the following variables:
| Variable | Description |
| --- | --- |
| ts | Time in seconds |
| sh | Source address |
| sp | Source port |
| rh | Destination address |
| dp | Destination port |
| by | Bytes in packet |
| ns | Next send sequence # |
| us | Unacknowledged sequence # |
| cw | Congestion window |
| ss | Slow start threshold |
| sw | Send window |

#### Client-Server Architecture ####

TODOs are in _italic_

* The clients obtain data through tcpprobe, _aggregates it_, and _sends it_ to the server each 10 seconds
* The server receives data from the clients, through ReST APIs, and _store_ them in a csv file 

### How to run it ###

#### Server ####
Go to netmonitor folder and run:
```
python3 server.py
```
#### Clients ####
_on each client_
First, tcp_probe have to be configured on(as _sudo_):
```
# mod_probe -r tcp_probe
# mod_prbe tcp_probe port=0 full=1
# chmod 444 /proc/net/tcpprobe
```
Then, go to netmonitor folder and run:
```
python3 client.py server_address
```
* or you can access it from the web, through REST APIs